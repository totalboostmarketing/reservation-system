# 予約システム 使い方ガイド

## 目次
1. [システム概要](#システム概要)
2. [お客様向け予約画面](#お客様向け予約画面)
3. [管理画面の使い方](#管理画面の使い方)
4. [各機能の詳細](#各機能の詳細)
5. [メール設定](#メール設定)
6. [トラブルシューティング](#トラブルシューティング)

---

## システム概要

### URL一覧
| 画面 | URL |
|------|-----|
| お客様向け予約画面 | https://reservation-system-three-liard.vercel.app/ja/booking |
| 管理画面ログイン | https://reservation-system-three-liard.vercel.app/ja/admin/login |
| 管理画面 | https://reservation-system-three-liard.vercel.app/ja/admin |

### ログイン情報（初期設定）
- **メールアドレス**: admin@example.com
- **パスワード**: admin123

⚠️ **本番運用前に必ずパスワードを変更してください**

---

## お客様向け予約画面

### 予約の流れ
1. **店舗選択** - 予約したい店舗を選択
2. **メニュー選択** - コース・メニューを選択
3. **スタッフ選択** - 担当スタッフを選択（指名なしも可）
4. **日時選択** - カレンダーから希望日時を選択
5. **お客様情報入力** - 名前、電話番号、メールアドレスを入力
6. **確認・予約完了** - 内容を確認して予約確定

### 予約キャンセル
- 予約完了メールに記載のキャンセルURLからキャンセル可能
- 管理画面からもキャンセル可能

---

## 管理画面の使い方

### メニュー一覧

| メニュー | 機能 |
|----------|------|
| 予約一覧 | 予約の検索・確認・ステータス変更・キャンセル |
| カレンダー | 日別・週別で予約状況をカレンダー表示 |
| サマリー | 予約数・売上の集計レポート |
| 店舗管理 | 店舗情報の追加・編集・削除 |
| メニュー管理 | コース・メニューの追加・編集・削除 |
| スタッフ管理 | スタッフの追加・編集・削除 |
| キャンペーン | 期間限定割引キャンペーンの管理 |
| クーポン | クーポンコードの発行・管理 |
| メールテンプレート | 自動送信メールの文面編集 |
| 設定 | システム全体の設定 |

---

## 各機能の詳細

### 予約一覧
- **検索・フィルター**: 店舗、期間、ステータスで絞り込み
- **ステータス変更**: 予約済み → 来店済み → キャンセル → ノーショー
- **CSVエクスポート**: 予約データをCSVでダウンロード

### 店舗管理
店舗の基本情報を管理します。

| 項目 | 説明 |
|------|------|
| 店舗名（日本語/英語） | 表示される店舗名 |
| 住所 | 店舗の所在地 |
| 電話番号 | 連絡先電話番号 |
| メールアドレス | 店舗のメールアドレス |
| ベッド数 | 同時施術可能数（予約枠の計算に使用） |
| Googleマップ URL | 地図リンク |

### メニュー管理
施術メニュー・コースを管理します。

| 項目 | 説明 |
|------|------|
| メニュー名（日本語/英語） | 表示されるメニュー名 |
| 説明文 | メニューの詳細説明 |
| 所要時間（分） | 施術にかかる時間 |
| 料金 | 税抜き価格 |
| 税率 | 消費税率（デフォルト10%） |
| 前バッファ | 施術前の準備時間 |
| 後バッファ | 施術後の片付け時間 |

### スタッフ管理
施術担当スタッフを管理します。

| 項目 | 説明 |
|------|------|
| スタッフ名（日本語/英語） | 表示される名前 |
| 所属店舗 | 勤務店舗 |
| 担当メニュー | 対応可能なメニュー |
| 表示順 | 一覧での並び順 |

### キャンペーン
期間限定の割引キャンペーンを設定できます。

| 項目 | 説明 |
|------|------|
| キャンペーン名 | 表示される名称 |
| 割引タイプ | 「パーセント」または「固定金額」 |
| 割引値 | 割引率または割引額 |
| 開始日・終了日 | キャンペーン期間 |
| 対象店舗 | 適用される店舗 |
| 対象メニュー | 適用されるメニュー |

### クーポン
クーポンコードを発行して割引を提供できます。

| 項目 | 説明 |
|------|------|
| クーポンコード | お客様が入力するコード（例: WELCOME500） |
| クーポン名 | 管理用の名称 |
| 割引タイプ | 「パーセント」または「固定金額」 |
| 割引値 | 割引率または割引額 |
| 有効期間 | 使用可能な期間 |
| 最低利用金額 | この金額以上で使用可能 |
| 利用回数上限 | 全体での使用回数制限 |
| 1人あたり上限 | 同一人物の使用回数制限 |

### メールテンプレート
自動送信されるメールの文面を編集できます。

#### テンプレートタイプ
| タイプ | 送信タイミング |
|--------|----------------|
| 予約完了 | 予約確定時にお客様へ送信 |
| 予約変更 | 予約内容変更時に送信 |
| 予約キャンセル | キャンセル時に送信 |
| リマインド | 予約日前日などに送信 |

#### 利用可能な変数
メール本文内で以下の変数を使用できます。自動的に実際の値に置き換わります。

| 変数 | 内容 |
|------|------|
| `{{customerName}}` | お客様のお名前 |
| `{{storeName}}` | 店舗名 |
| `{{menuName}}` | メニュー名 |
| `{{staffName}}` | スタッフ名 |
| `{{dateTime}}` | 予約日時 |
| `{{cancelUrl}}` | キャンセル用URL |
| `{{reservationId}}` | 予約ID |

#### テンプレート例（予約完了メール）
```
件名: 【{{storeName}}】ご予約ありがとうございます

本文:
{{customerName}} 様

この度は{{storeName}}をご予約いただき、誠にありがとうございます。

【ご予約内容】
店舗: {{storeName}}
メニュー: {{menuName}}
担当: {{staffName}}
日時: {{dateTime}}

ご予約のキャンセル・変更は下記URLより可能です。
{{cancelUrl}}

ご来店を心よりお待ちしております。
```

---

## メール設定

### SMTP設定
メールを実際に送信するには、Vercelの環境変数に以下を設定してください。

```
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password
SMTP_FROM=Your Salon <your-email@gmail.com>
```

### Gmail App Password の取得方法
1. Googleアカウントにログイン
2. 「セキュリティ」→「2段階認証プロセス」を有効化
3. 「アプリパスワード」を選択
4. 「メール」を選択してパスワードを生成
5. 生成された16文字のパスワードを `SMTP_PASS` に設定

### Vercelでの環境変数設定
1. Vercelダッシュボード → プロジェクト → Settings
2. Environment Variables をクリック
3. 上記の変数を追加
4. 「Save」をクリック
5. プロジェクトを再デプロイ

---

## トラブルシューティング

### よくある問題と解決方法

#### 「読み込み中」から進まない
- ブラウザのキャッシュをクリア
- シークレットモードで試す
- ページを再読み込み

#### ログインできない
- メールアドレス: admin@example.com
- パスワード: admin123
- 5回失敗するとアカウントがロックされます（30分後に解除）

#### 予約完了メールが届かない
- SMTP設定が正しいか確認
- 迷惑メールフォルダを確認
- Vercelのログでエラーを確認

#### 店舗・メニューが表示されない
- データベースに初期データがあるか確認
- APIエラーがないかブラウザの開発者ツールで確認

### サポート
問題が解決しない場合は、システム管理者にお問い合わせください。

---

## 更新履歴

| 日付 | 内容 |
|------|------|
| 2025-11-22 | 初版作成 |
